<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Session Storage Example</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        .container {
            background: #f5f5f5;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
        }
        button {
            background: #28a745;
            color: white;
            border: none;
            padding: 10px 20px;
            margin: 5px;
            border-radius: 4px;
            cursor: pointer;
        }
        button:hover {
            background: #218838;
        }
        select {
            padding: 8px;
            margin: 5px;
            border-radius: 4px;
            border: 1px solid #ddd;
        }
        .count {
            font-size: 18px;
            font-weight: bold;
            margin: 10px 0;
        }
        .info {
            background: #d1ecf1;
            border: 1px solid #bee5eb;
            color: #0c5460;
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <h1>Session Storage Example</h1>
    <p>This example demonstrates how to use <code>usePersistedState</code> with sessionStorage.</p>

    <div class="info">
        <strong>Note:</strong> sessionStorage data persists only for the current browser session.
        It will be cleared when you close the browser tab or window.
    </div>

    <div id="root"></div>

    <script src="https://unpkg.com/react@19/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@19/umd/react-dom.development.js"></script>
    <script type="module">
        import createPersistedState from '../../lib/index.js'
        import storage from '../../lib/storages/session-storage.js'

        const { useState } = React
        const { createRoot } = ReactDOM

        const [usePersistedState, clear] = createPersistedState('session_example', storage)
        const initialValue = 0

        function Actions() {
            const [key, setKey] = usePersistedState('selectedKey', 'count')
            const [, setCount] = usePersistedState(key, initialValue)

            const handleChange = (event) => {
                const { value } = event.target
                setKey(value)
            }

            return React.createElement('div', null, [
                React.createElement('div', { key: 'selector' }, [
                    React.createElement('label', { key: 'label' }, 'Select key: '),
                    React.createElement('select', {
                        key: 'select',
                        onChange: handleChange,
                        value: key
                    }, [
                        React.createElement('option', { key: 'count', value: 'count' }, 'Count'),
                        React.createElement('option', { key: 'number', value: 'number' }, 'Number')
                    ])
                ]),
                React.createElement('div', { key: 'buttons' }, [
                    React.createElement('button', {
                        key: 'minus',
                        onClick: () => setCount(prevCount => prevCount - 1)
                    }, '-'),
                    React.createElement('button', {
                        key: 'clear',
                        onClick: () => clear()
                    }, 'Clear'),
                    React.createElement('button', {
                        key: 'initial',
                        onClick: () => setCount(initialValue)
                    }, 'Initial'),
                    React.createElement('button', {
                        key: 'plus',
                        onClick: () => setCount(prevCount => prevCount + 1)
                    }, '+')
                ])
            ])
        }

        function Count() {
            const [count] = usePersistedState('count', initialValue)
            const [number] = usePersistedState('number', initialValue)

            return React.createElement('div', { className: 'count' }, [
                'Count: ', count, ' | Number: ', number
            ])
        }

        function App() {
            return React.createElement('div', { className: 'container' }, [
                React.createElement(Count, { key: 'count' }),
                React.createElement('hr', { key: 'hr' }),
                React.createElement(Actions, { key: 'actions' }),
                React.createElement('p', { key: 'description' }, [
                    'This example shows how values are persisted in sessionStorage. ',
                    'Try changing the values and refreshing the page - they will persist. ',
                    'However, if you close this tab and open a new one, the values will be reset.'
                ])
            ])
        }

        const root = createRoot(document.getElementById('root'))
        root.render(React.createElement(App))
    </script>
</body>
</html>
