# Custom instructions for GitHub Copilot

## Project Overview
- **Project**: TypeScript React library providing a `usePersistedState` hook that persists state to web storage or custom adapters
- **Package**: `@plq/use-persisted-state` - A lightweight, type-safe state persistence solution for React applications
- **Languages & tooling**: TypeScript, React ≥16.8 (Hooks support), Jest for testing, ESLint for linting
- **Runtime dependencies**: Only `@plq/is` (minimal utility library)
- **React compatibility**: Supports React 16.8+, React 18, and React 19 with full feature compatibility

## Project Layout
- `/src` — Library source code (TypeScript)
  - Main entry point: `index.ts`
  - Core hooks: `create-persisted-state.ts`, `create-async-persisted-state.ts`
  - Storage adapters: `/storages` directory
  - Type definitions: `/@types` directory
- `/__tests__` — Unit tests (Jest with TypeScript)
- `/docs` — Documentation files
- `/demo` — Example application demonstrating usage
- `/lib` — Compiled output (generated by TypeScript compiler)

## Build & Development Commands
- **Install**: `npm ci` (use exact versions from package-lock.json)
- **Build**: `npm run build` (TypeScript compilation)
- **Test**: `npm test` (Jest with verbose output)
- **Lint**: `npm run lint` (ESLint on TypeScript files)
- **Demo**: `npm run demo` (Vite development server for examples)

## Code Style & Quality Standards

### TypeScript & API Design
- Keep types **explicit** and **public API stable** - avoid breaking changes without a major version bump
- Use proper TypeScript generics for type safety, especially in hook return types
- Export types from main index for consumer convenience
- Maintain backward compatibility across React versions (16.8, 18, 19)

### Testing Requirements
- **Add/update tests** for all behavior changes - tests should be deterministic and isolated
- Use Jest with React Testing Library for component testing
- Mock storage/adapters in unit tests - avoid real browser storage dependencies
- Cover edge cases, especially for storage operations and type handling
- Test files follow pattern: `*.test.ts` or `*.test.tsx`

### Documentation & Examples
- **Update docs/examples** if API or behavior changes
- Keep README.md current with usage examples
- Maintain CHANGELOG.md following conventional commits
- Demo applications should showcase real-world usage patterns

### Performance & Dependencies
- No unnecessary runtime dependencies - keep the library lightweight
- Storage operations should be efficient and handle errors gracefully
- Support both synchronous and asynchronous storage adapters
- Proper cleanup of event listeners and side effects

### React Best Practices
- Follow React Hooks conventions and rules
- Support concurrent features in React 18/19
- Handle SSR scenarios properly (no browser-only code in initial render)
- Proper handling of React StrictMode (double effect execution)